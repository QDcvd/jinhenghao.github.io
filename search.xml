<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      
        <title>hexo-butterfly博客搜索功能的实现</title>
      
      <link href="/posts/50561.html"/>
      <url>/posts/50561.html</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近一直想给自己的博客添加搜索功能，用于搜索自己的贴子。经过搜索一些教程并结合自己的思考，遂整理成这样的贴子用以记录下部署过程。</p><p>最终实现效果如下（输入123即可弹出搜索结果）：</p><p><img src="/images/image.png" alt="image.png"></p><h2 id="插件的安装"><a href="#插件的安装" class="headerlink" title="插件的安装"></a>插件的安装</h2><p>此搜索功能是借助于hexo-generator-search插件实现的，要用到这个功能，需要安装此插件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure><p>此外，在__config.xml文件下增加功能：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  content: true</span><br><span class="line">  template: ./search.xml</span><br></pre></td></tr></table></figure><p>然后，在博客的目录下新增search.xml，这个xml文件是一个搜索模板，没有它就无法生成搜索结果。</p><p>search.xml可在GitHub上进行下载。链接如下：<a href="https://github.com/wzpan/hexo-generator-search/blob/master/templates/search.xml">https://github.com/wzpan/hexo-generator-search/blob/master/templates/search.xml</a></p><p>其代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">search</span>&gt;</span> </span><br><span class="line">  &#123;% if posts %&#125;</span><br><span class="line">  &#123;% for post in posts.toArray() %&#125;</span><br><span class="line">    &#123;% if post.indexing == undefined or post.indexing %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">      &#123;% if post.title %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;&#123; post.title &#125;&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">      &#123;% else %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>No Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; (url + post.path) | uriencode &#125;&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>&#123;&#123; (url + post.path) | uriencode &#125;&#125;<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">      &#123;% if content %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">content</span> <span class="attr">type</span>=<span class="string">&quot;html&quot;</span>&gt;</span>&lt;![CDATA[&#123;&#123; post.content | noControlChars | safe &#125;&#125;]]&gt;<span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">      &#123;% if post.categories and post.categories.length&gt;0 %&#125;</span><br><span class="line">      <span class="tag">&lt;<span class="name">categories</span>&gt;</span></span><br><span class="line">          &#123;% for cate in post.categories.toArray() %&#125;</span><br><span class="line">          <span class="tag">&lt;<span class="name">category</span>&gt;</span> &#123;&#123; cate.name &#125;&#125; <span class="tag">&lt;/<span class="name">category</span>&gt;</span></span><br><span class="line">          &#123;% endfor %&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">categories</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">      &#123;% if post.tags and post.tags.length&gt;0 %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">tags</span>&gt;</span></span><br><span class="line">            &#123;% for tag in post.tags.toArray() %&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">tag</span>&gt;</span> &#123;&#123; tag.name &#125;&#125; <span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br><span class="line">            &#123;% endfor %&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">tags</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% if pages %&#125;</span><br><span class="line">    &#123;% for page in pages.toArray() %&#125;</span><br><span class="line">    &#123;% if post.indexing == undefined or post.indexing %&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;&#123; page.title &#125;&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; (url + page.path) | uriencode &#125;&#125;&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">url</span>&gt;</span>&#123;&#123; (url + page.path) | uriencode &#125;&#125;<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">      &#123;% if content %&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">content</span> <span class="attr">type</span>=<span class="string">&quot;html&quot;</span>&gt;</span>&lt;![CDATA[&#123;&#123; page.content | noControlChars | safe &#125;&#125;]]&gt;<span class="tag">&lt;/<span class="name">content</span>&gt;</span></span><br><span class="line">      &#123;% endif %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">    &#123;% endfor %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">search</span>&gt;</span></span><br></pre></td></tr></table></figure><p>下一步，将search.js放到主题目录下的js文件夹内，也就是E:\[你的项目目录]\themes\butterfly\source\js里面</p><p>需要新建一个js文件，并且取名为search</p><p>search.js内代码如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// A local search script with the help of [hexo-generator-search](https://github.com/PaicHyperionDev/hexo-generator-search)</span></span><br><span class="line"><span class="comment">// Copyright (C) 2015 </span></span><br><span class="line"><span class="comment">// Joseph Pan &lt;http://github.com/wzpan&gt;</span></span><br><span class="line"><span class="comment">// Shuhao Mao &lt;http://github.com/maoshuhao&gt;</span></span><br><span class="line"><span class="comment">// This library is free software; you can redistribute it and/or modify</span></span><br><span class="line"><span class="comment">// it under the terms of the GNU Lesser General Public License as</span></span><br><span class="line"><span class="comment">// published by the Free Software Foundation; either version 2.1 of the</span></span><br><span class="line"><span class="comment">// License, or (at your option) any later version.</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// This library is distributed in the hope that it will be useful, but</span></span><br><span class="line"><span class="comment">// WITHOUT ANY WARRANTY; without even the implied warranty of</span></span><br><span class="line"><span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></span><br><span class="line"><span class="comment">// Lesser General Public License for more details.</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// You should have received a copy of the GNU Lesser General Public</span></span><br><span class="line"><span class="comment">// License along with this library; if not, write to the Free Software</span></span><br><span class="line"><span class="comment">// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></span><br><span class="line"><span class="comment">// 02110-1301 USA</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> searchFunc = <span class="keyword">function</span>(<span class="params">path, search_id, content_id</span>) &#123;</span><br><span class="line">    <span class="string">&#x27;use strict&#x27;</span>;</span><br><span class="line">    $.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>: path,</span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&quot;xml&quot;</span>,</span><br><span class="line">        <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params"> xmlResponse </span>) &#123;</span><br><span class="line">            <span class="comment">// get the contents from search data</span></span><br><span class="line">            <span class="keyword">var</span> datas = $( <span class="string">&quot;entry&quot;</span>, xmlResponse ).<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    <span class="attr">title</span>: $( <span class="string">&quot;title&quot;</span>, <span class="variable language_">this</span> ).<span class="title function_">text</span>(),</span><br><span class="line">                    <span class="attr">content</span>: $(<span class="string">&quot;content&quot;</span>,<span class="variable language_">this</span>).<span class="title function_">text</span>(),</span><br><span class="line">                    <span class="attr">url</span>: $( <span class="string">&quot;url&quot;</span> , <span class="variable language_">this</span>).<span class="title function_">text</span>()</span><br><span class="line">                &#125;;</span><br><span class="line">            &#125;).<span class="title function_">get</span>();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> $input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(search_id);</span><br><span class="line"><span class="keyword">if</span> (!$input) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">var</span> $resultContent = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(content_id);</span><br><span class="line">            <span class="keyword">if</span> ($(<span class="string">&quot;#local-search-input&quot;</span>).<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                $input.<span class="title function_">addEventListener</span>(<span class="string">&#x27;input&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="keyword">var</span> str = <span class="string">&#x27;&lt;ul class=\&quot;search-result-list\&quot;&gt;&#x27;</span>;</span><br><span class="line">                    <span class="keyword">var</span> keywords = <span class="variable language_">this</span>.<span class="property">value</span>.<span class="title function_">trim</span>().<span class="title function_">toLowerCase</span>().<span class="title function_">split</span>(<span class="regexp">/[\s\-]+/</span>);</span><br><span class="line">                    $resultContent.<span class="property">innerHTML</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">value</span>.<span class="title function_">trim</span>().<span class="property">length</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// perform local searching</span></span><br><span class="line">                    datas.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">                        <span class="keyword">var</span> isMatch = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">var</span> content_index = [];</span><br><span class="line">                        <span class="keyword">if</span> (!data.<span class="property">title</span> || data.<span class="property">title</span>.<span class="title function_">trim</span>() === <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">                            data.<span class="property">title</span> = <span class="string">&quot;Untitled&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">var</span> data_title = data.<span class="property">title</span>.<span class="title function_">trim</span>().<span class="title function_">toLowerCase</span>();</span><br><span class="line">                        <span class="keyword">var</span> data_content = data.<span class="property">content</span>.<span class="title function_">trim</span>().<span class="title function_">replace</span>(<span class="regexp">/&lt;[^&gt;]+&gt;/g</span>, <span class="string">&quot;&quot;</span>).<span class="title function_">toLowerCase</span>();</span><br><span class="line">                        <span class="keyword">var</span> data_url = data.<span class="property">url</span>;</span><br><span class="line">                        <span class="keyword">var</span> index_title = -<span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">var</span> index_content = -<span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">var</span> first_occur = -<span class="number">1</span>;</span><br><span class="line">                        <span class="comment">// only match artiles with not empty contents</span></span><br><span class="line">                        <span class="keyword">if</span> (data_content !== <span class="string">&#x27;&#x27;</span>) &#123;</span><br><span class="line">                            keywords.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">keyword, i</span>) &#123;</span><br><span class="line">                                index_title = data_title.<span class="title function_">indexOf</span>(keyword);</span><br><span class="line">                                index_content = data_content.<span class="title function_">indexOf</span>(keyword);</span><br><span class="line"></span><br><span class="line">                                <span class="keyword">if</span> (index_title &lt; <span class="number">0</span> &amp;&amp; index_content &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                                    isMatch = <span class="literal">false</span>;</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    <span class="keyword">if</span> (index_content &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                                        index_content = <span class="number">0</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">                                        first_occur = index_content;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="comment">// content_index.push(&#123;index_content:index_content, keyword_len:keyword_len&#125;);</span></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            isMatch = <span class="literal">false</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// show search results</span></span><br><span class="line">                        <span class="keyword">if</span> (isMatch) &#123;</span><br><span class="line">                            str += <span class="string">&quot;&lt;li&gt;&lt;a href=&#x27;&quot;</span> + data_url + <span class="string">&quot;&#x27; class=&#x27;search-result-title&#x27;&gt;&quot;</span> + data_title + <span class="string">&quot;&lt;/a&gt;&quot;</span>;</span><br><span class="line">                            <span class="keyword">var</span> content = data.<span class="property">content</span>.<span class="title function_">trim</span>().<span class="title function_">replace</span>(<span class="regexp">/&lt;[^&gt;]+&gt;/g</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">                            <span class="keyword">if</span> (first_occur &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                                <span class="comment">// cut out 100 characters</span></span><br><span class="line">                                <span class="keyword">var</span> start = first_occur - <span class="number">20</span>;</span><br><span class="line">                                <span class="keyword">var</span> end = first_occur + <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line">                                <span class="keyword">if</span> (start &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                                    start = <span class="number">0</span>;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                <span class="keyword">if</span> (start == <span class="number">0</span>) &#123;</span><br><span class="line">                                    end = <span class="number">100</span>;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                <span class="keyword">if</span> (end &gt; content.<span class="property">length</span>) &#123;</span><br><span class="line">                                    end = content.<span class="property">length</span>;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                <span class="keyword">var</span> match_content = content.<span class="title function_">substring</span>(start, end);</span><br><span class="line"></span><br><span class="line">                                <span class="comment">// highlight all keywords</span></span><br><span class="line">                                keywords.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">keyword</span>) &#123;</span><br><span class="line">                                    <span class="keyword">var</span> regS = <span class="keyword">new</span> <span class="title class_">RegExp</span>(keyword, <span class="string">&quot;gi&quot;</span>);</span><br><span class="line">                                    match_content = match_content.<span class="title function_">replace</span>(regS, <span class="string">&quot;&lt;em class=\&quot;search-keyword\&quot;&gt;&quot;</span> + keyword + <span class="string">&quot;&lt;/em&gt;&quot;</span>);</span><br><span class="line">                                &#125;);</span><br><span class="line"></span><br><span class="line">                                str += <span class="string">&quot;&lt;p class=\&quot;search-result\&quot;&gt;&quot;</span> + match_content + <span class="string">&quot;...&lt;/p&gt;&quot;</span></span><br><span class="line">                            &#125;</span><br><span class="line">                            str += <span class="string">&quot;&lt;/li&gt;&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    str += <span class="string">&quot;&lt;/ul&gt;&quot;</span>;</span><br><span class="line">                    $resultContent.<span class="property">innerHTML</span> = str;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>至此，插件的安装完成</p><h2 id="在页面添加搜索功能"><a href="#在页面添加搜索功能" class="headerlink" title="在页面添加搜索功能"></a>在页面添加搜索功能</h2><p>我在这里是添加了个搜索页面，具体在_config.butterfly.xml进行操作，就先不演示了</p><p>然后，到source文件夹处新建一个search文件夹，并新建一个index.md，内容如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: </span><br><span class="line">abbrlink:</span><br><span class="line">date: 2025-08-16 19:07:46</span><br><span class="line">---</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        * &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-family</span>: <span class="string">&quot;Microsoft YaHei&quot;</span>,<span class="string">&quot;宋体&quot;</span>,<span class="string">&quot;Segoe UI&quot;</span>, <span class="string">&quot;Lucida Grande&quot;</span>, Helvetica, Arial,sans-serif, FreeSans, Arimo;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#site_search</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">820px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span><span class="selector-class">.search</span> &#123;<span class="attribute">padding</span>: <span class="number">30px</span> <span class="number">0</span>;&#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">form</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">550px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">input</span>, <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">outline</span>: none;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">input</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">42px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding-left</span>: <span class="number">13px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">42px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">42px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="comment">/*搜索框1*/</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.bar1</span> &#123;<span class="attribute">background</span>: white;&#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.bar1</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#7BA7AB</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: <span class="number">#ffffffff</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#9E9C9C</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.bar1</span> <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: <span class="number">#7BA7AB</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">5px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.bar1</span> <span class="selector-tag">button</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">content</span>: <span class="string">&quot;\f002&quot;</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-family</span>: FontAwesome;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#F9F0DA</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;site_search&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group bar1&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;local-search-input&quot;</span> <span class="attr">name</span>=<span class="string">&quot;q&quot;</span> <span class="attr">results</span>=<span class="string">&quot;0&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入您要搜索的内容...&quot;</span> <span class="attr">class</span>=<span class="string">&quot;st-search-input st-default-search-input form-control&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;local-search-result&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;div id=&quot;site_search&quot;&gt;</span></span><br><span class="line"><span class="comment">   &lt;div class=&quot;form-group&quot;&gt;</span></span><br><span class="line"><span class="comment">    &lt;input type=&quot;text&quot; id=&quot;local-search-input&quot; name=&quot;q&quot; results=&quot;0&quot; placeholder=&quot;Search&quot; class=&quot;st-search-input st-default-search-input form-control&quot;&gt;</span></span><br><span class="line"><span class="comment">   &lt;/div&gt;  </span></span><br><span class="line"><span class="comment">  &lt;div id=&quot;local-search-result&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="comment">&lt;/div&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/js/search.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> search_path = <span class="string">&quot;search.xml&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (search_path.<span class="property">length</span> == <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    search_path = <span class="string">&quot;search.xml&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> path = <span class="string">&quot;/&quot;</span> + search_path;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">searchFunc</span>(path, <span class="string">&#x27;local-search-input&#x27;</span>, <span class="string">&#x27;local-search-result&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>该index.md分成几个内容，一个是搜索框，一个是脚本功能的添加，最后一部分是css样式</p><h3 id="搜索框"><a href="#搜索框" class="headerlink" title="搜索框"></a>搜索框</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;site_search&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;form-group bar1&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;local-search-input&quot;</span> <span class="attr">name</span>=<span class="string">&quot;q&quot;</span> <span class="attr">results</span>=<span class="string">&quot;0&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入您要搜索的内容...&quot;</span> <span class="attr">class</span>=<span class="string">&quot;st-search-input st-default-search-input form-control&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;local-search-result&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;/js/search.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> search_path = <span class="string">&quot;search.xml&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (search_path.<span class="property">length</span> == <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    search_path = <span class="string">&quot;search.xml&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> path = <span class="string">&quot;/&quot;</span> + search_path;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">searchFunc</span>(path, <span class="string">&#x27;local-search-input&#x27;</span>, <span class="string">&#x27;local-search-result&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>其中</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>一定要放在最前面，否则会出现Uncaught ReferenceError: $ is not defined报错。</p><p>在md页面添加以上两个代码块后，基本上就能实现搜索功能。还可以用css代码块对搜索框作一些装饰，这里我就抄网上的一些代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        * &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-sizing</span>: border-box;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: white;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-family</span>: <span class="string">&quot;Microsoft YaHei&quot;</span>,<span class="string">&quot;宋体&quot;</span>,<span class="string">&quot;Segoe UI&quot;</span>, <span class="string">&quot;Lucida Grande&quot;</span>, Helvetica, Arial,sans-serif, FreeSans, Arimo;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#site_search</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">820px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span><span class="selector-class">.search</span> &#123;<span class="attribute">padding</span>: <span class="number">30px</span> <span class="number">0</span>;&#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">form</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">550px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span> auto;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">input</span>, <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">outline</span>: none;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">input</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">42px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding-left</span>: <span class="number">13px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">42px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">42px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="comment">/*搜索框1*/</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.bar1</span> &#123;<span class="attribute">background</span>: white;&#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.bar1</span> <span class="selector-tag">input</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#7BA7AB</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: <span class="number">#ffffffff</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#9E9C9C</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.bar1</span> <span class="selector-tag">button</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: <span class="number">#7BA7AB</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">5px</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.bar1</span> <span class="selector-tag">button</span><span class="selector-pseudo">:before</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">content</span>: <span class="string">&quot;\f002&quot;</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-family</span>: FontAwesome;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="number">#F9F0DA</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>以上工作做完后，在控制台输入hexo cl; hexo g; hexo d</p><p>对网站进行部署即可使用。</p>]]></content>
      
      
      <categories>
          
          <category> 博客搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>windows下基于anaconda的开源版pymol的安装</title>
      
      <link href="/posts/dae04dfc.html"/>
      <url>/posts/dae04dfc.html</url>
      
        <content type="html"><![CDATA[<div style="position: relative;width: 100%;height: 0;padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=251755920&bvid=BV16Y411x7vX&cid=445366750&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"></iframe></div><p>安装pymol时用的是win7，也能适用于win10，只不过我主机已经安装了,这里是开了个虚拟机演示。</p><p>Unofficial Windows Binaries for Python Extension Packages地址(用于下载pymol包)：<br><a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">https://www.lfd.uci.edu/~gohlke/pythonlibs/</a><br>链接挂掉了，但是可以通过github的release进入下载</p><p>Anaconda官网：<br><a href="https://www.anaconda.com/">https://www.anaconda.com/</a></p><p>如果使用pip命令出现无法安装的问题，视情况而解决，不过很有可能只是需要更换为国内镜像就可以了，在这里提供一个临时调用镜像源的命令(这里的some-package指的是包的文件，比如pymol-2.6.0a0-cp38-cp38-win_amd64.whl)：</p><p>pip install some-package -i <a href="https://pypi.tuna.tsinghua.edu.cn/simple/">https://pypi.tuna.tsinghua.edu.cn/simple/</a></p><p>win版本的gromacs安装，对于win7用户来说，设置环境变量也是一样，只不过在搜索那里改成“环境变量”——&gt;选择系统环境变量进行修改就行。 需要注意的是，win7的环境变量是没有新建的按钮，如果要添加新的环境变量，需要在原来的环境变量的基础上，写入一个分号进行分隔（比如C:\abc;C:\cde;C:\aaa;C:\bbb），再将地址粘贴上去保存确定</p>]]></content>
      
      
      <categories>
          
          <category> 生物信息 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      
        <title>wormlab3.0使用介绍</title>
      
      <link href="/posts/f42a359e.html"/>
      <url>/posts/f42a359e.html</url>
      
        <content type="html"><![CDATA[<div style="position: relative;width: 100%;height: 0;padding-bottom: 75%;"><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=114494449648083&bvid=BV1UREEzAEyz&cid=29924330369&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;"></iframe></div><p><a href="https://www.youtube.com/watch?v=OdZGgVD_iv4">https://www.youtube.com/watch?v=OdZGgVD_iv4</a></p><p>视频转载自油管，并使用deepseek自动进行翻译</p>]]></content>
      
      
      <categories>
          
          <category> 湿实验相关 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      
        <title>基于AutoDock-Vina的小分子并行对接</title>
      
      <link href="/posts/253ea9a.html"/>
      <url>/posts/253ea9a.html</url>
      
        <content type="html"><![CDATA[<p>需求：有一个需要用一种受体对八千多个小分子对接的任务，故写下此脚本。</p><p>对接数据如下：</p><p><img src="/images/localImg/225f85c99d5c5b60c2a7eea2b5c6326e.png" alt="225f85c99d5c5b60c2a7eea2b5c6326e.png"></p><p>不同名称的中药</p><p><img src="/images/localImg/3eac42f37e0f2081005e43f1bddcc0b5.png" alt="3eac42f37e0f2081005e43f1bddcc0b5.png"></p><p>其中一种中药含有的各种成分，已经通过 prepare_receptor4.py 批量转换为 pdbqt 文件</p><p>对接脚本如下，放到不同中药文件夹的目录下运行即可（linux）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Created on *********</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@author: 真弓快车</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">该脚本的目的是检查因为异常而未能对接成功的分子，再批量对接</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">example:</span></span><br><span class="line"><span class="string">vina --ligand ./*/*.pdbqt --out result.pdbqt --config 2oxe.conf &gt; result.log</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> Parallel, delayed</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">docker</span>(<span class="params">ingredient, medname</span>): <span class="comment"># 并行处理函数</span></span><br><span class="line">    os.system(<span class="string">&quot;vina --ligand ./&quot;</span>+medname+<span class="string">&#x27;/&#x27;</span> + ingredient + <span class="string">&quot; --out ./&quot;</span>+medname+<span class="string">&#x27;/&#x27;</span> + <span class="built_in">str</span>(ingredient).replace(<span class="string">&quot;.pdbqt&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;_out.pdbqt --config 2oxe.conf &gt; ./&quot;</span>+medname+<span class="string">&quot;/&quot;</span>+ingredient.replace(<span class="string">&#x27;.pdbqt&#x27;</span>,<span class="string">&quot;.log&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    medList = os.listdir()</span><br><span class="line">    <span class="keyword">for</span> medname <span class="keyword">in</span> tqdm(medList):</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> medname:</span><br><span class="line">            <span class="comment"># print(medname)  # 定位到植物</span></span><br><span class="line">            ingredientList = os.listdir(<span class="string">&#x27;./&#x27;</span>+medname+<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># print(ingredientList)</span></span><br><span class="line">            ingredientList_outPdbqt = []</span><br><span class="line">            <span class="keyword">for</span> iop <span class="keyword">in</span> ingredientList:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;_out&#x27;</span> <span class="keyword">in</span> iop:</span><br><span class="line">                    ingredientList_outPdbqt.append(iop)</span><br><span class="line">        </span><br><span class="line">            <span class="comment"># print(ingredientList_outPdbqt)</span></span><br><span class="line">            ingredientList_outPdbqt_1 = []</span><br><span class="line">            <span class="keyword">for</span> iop1 <span class="keyword">in</span> ingredientList_outPdbqt:</span><br><span class="line">                iop1 = iop1.replace(<span class="string">&#x27;_out&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                ingredientList_outPdbqt_1.append(iop1)</span><br><span class="line">            <span class="comment"># print(ingredientList_outPdbqt_1)</span></span><br><span class="line">        </span><br><span class="line">            ingredientNotOutNotLogList = []</span><br><span class="line">            <span class="keyword">for</span> inonl <span class="keyword">in</span> ingredientList:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;_out&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> inonl:</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;.log&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> inonl:</span><br><span class="line">                        ingredientNotOutNotLogList.append(inonl)</span><br><span class="line">            <span class="comment"># print(ingredientNotOutNotLogList)</span></span><br><span class="line"></span><br><span class="line">            ingredientNotDock = <span class="built_in">list</span>(<span class="built_in">set</span>(ingredientNotOutNotLogList)-<span class="built_in">set</span>(ingredientList_outPdbqt_1))</span><br><span class="line">            <span class="comment"># print(ingredientNotDock)</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">            <span class="comment"># for ingredient in ingredientNotDock:</span></span><br><span class="line">            <span class="comment">#     # print(ingredient)   # 定位到具体植物具体未对接的成分</span></span><br><span class="line">            <span class="comment">#     print(&quot;vina --ligand ./&quot;+medname+&#x27;/&#x27; + ingredient + &quot; --out ./&quot;+medname+&#x27;/&#x27; + str(ingredient).replace(&quot;.pdbqt&quot;, &quot;&quot;) + &quot;_out.pdbqt --config 2oxe.conf &gt; ./&quot;+medname+&quot;/&quot;+ingredient.replace(&#x27;.pdbqt&#x27;,&quot;.log&quot;))</span></span><br><span class="line">            <span class="comment">#     pass</span></span><br><span class="line"></span><br><span class="line">            Parallel(n_jobs=-<span class="number">1</span>)(delayed(docker)(ingredient, medname) <span class="keyword">for</span> ingredient <span class="keyword">in</span> ingredientNotDock)</span><br><span class="line"></span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>运行完毕后还需要将所有的结果导出，故写了下列数据整理代码。放到不同中药文件夹的上一级目录，名称改成ingredientPdbqt，或者直接修改脚本也可。示例：</p><p><img src="/images/localImg/8674f821964996a3af1d5edfaf0770cb.png" alt="8674f821964996a3af1d5edfaf0770cb.png"></p><p>数据整理脚本如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Created on *********</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@author: 真弓快车</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">该脚本的目的是将所有的txt文件整理输出为一个csv文件</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">example:</span></span><br><span class="line"><span class="string">vina --ligand ./*/*.pdbqt --out result.pdbqt --config 2oxe.conf &gt; result.log</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log2List</span>(<span class="params">medfile, pdbqtFile</span>):</span><br><span class="line">    <span class="comment"># dockResult = []</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./ingredientPdbqt/&quot;</span>+medfile+<span class="string">&#x27;/&#x27;</span>+pdbqtFile, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> logfile:</span><br><span class="line">        <span class="comment"># print(pdbqtFile, logfile.readlines()[38][10:18])  # 对接结果</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            dockResult = logfile.readlines()[<span class="number">38</span>][<span class="number">10</span>:<span class="number">18</span>]</span><br><span class="line">            <span class="built_in">print</span>(pdbqtFile, dockResult)</span><br><span class="line">            <span class="keyword">return</span> dockResult</span><br><span class="line">        <span class="keyword">except</span> IndexError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;None&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 文件夹初始化</span></span><br><span class="line">    originFileList = os.listdir()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;csv&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> originFileList:</span><br><span class="line">        os.mkdir(<span class="string">&#x27;csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    medfiles = os.listdir(<span class="string">&quot;./ingredientPdbqt&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> medfile <span class="keyword">in</span> medfiles:</span><br><span class="line">        <span class="comment"># print(medfile)  定位到药食同源文件夹</span></span><br><span class="line">        pdbqtFiles = os.listdir(<span class="string">&quot;./ingredientPdbqt/&quot;</span>+medfile)</span><br><span class="line">        <span class="keyword">for</span> pdbqtFile <span class="keyword">in</span> pdbqtFiles:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;.log&#x27;</span> <span class="keyword">in</span> pdbqtFile:</span><br><span class="line">                dockResult = log2List(medfile, pdbqtFile)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./csv/&quot;</span>+medfile+<span class="string">&#x27;.csv&#x27;</span>, <span class="string">&#x27;a+&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">                    csvfile.write(pdbqtFile+<span class="string">&#x27;,&#x27;</span>+dockResult+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算对接平均值并改名</span></span><br><span class="line">    csvListDir = os.listdir(<span class="string">&quot;./csv&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> csvFile <span class="keyword">in</span> csvListDir:</span><br><span class="line">        csvContent = pd.read_csv(<span class="string">&#x27;./csv/&#x27;</span>+csvFile)</span><br><span class="line">        dockingResultList = csvContent.iloc[:, <span class="number">1</span>]</span><br><span class="line">        dockingMean = np.mean(dockingResultList)</span><br><span class="line">        <span class="built_in">print</span>(csvFile+<span class="string">&#x27;平均对接分数&#x27;</span>+<span class="built_in">str</span>(dockingMean))</span><br><span class="line">        os.rename(<span class="string">&#x27;./csv/&#x27;</span>+csvFile, <span class="string">&#x27;./csv/&#x27;</span>+<span class="built_in">str</span>(<span class="built_in">round</span>(<span class="built_in">float</span>(dockingMean), <span class="number">4</span>))+<span class="string">&#x27;=&#x27;</span>+csvFile)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>注意运行该脚本前，要保证ingredientPdbqt 文件夹只有文件夹，没有任何文件存在。否则会运行错误。</p><p>已知 Bug：使用该脚本时有时会出现控制台出现”Killed“字样，这是因为内存不足导致系统强制中止其中一个对接的进程。解决办法是将 Parallel(n_jobs&#x3D;-1)里面的”-1”改成低于你 cpu 的核数。要么你运行多几次这个脚本。保证每个对接都能顺利进行。</p>]]></content>
      
      
      <categories>
          
          <category> 生物信息 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分子对接 </tag>
            
            <tag> AutoDock-Vina </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>一个简单的训练集划分脚本</title>
      
      <link href="/posts/175df0b4.html"/>
      <url>/posts/175df0b4.html</url>
      
        <content type="html"><![CDATA[<p>需求：需要对数据集进行 0.7 比例的训练集验证集划分，并分配 100 张图片作为测试集</p><p>基于以上需求编写该脚本，代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    splitNum = <span class="number">0.7</span>  <span class="comment"># 训练集验证集划分比例</span></span><br><span class="line">    imagePath = <span class="string">&#x27;./wormPic/images/&#x27;</span></span><br><span class="line">    txtPath = <span class="string">&#x27;./wormPic/txt/&#x27;</span></span><br><span class="line"></span><br><span class="line">    imageList = os.listdir(imagePath)</span><br><span class="line">    txtList = os.listdir(txtPath)</span><br><span class="line"></span><br><span class="line">    totalNum = <span class="built_in">len</span>(imageList)</span><br><span class="line">    testNum = <span class="number">100</span>  <span class="comment"># 默认100张图片作为测试集</span></span><br><span class="line">    totalNum = totalNum - <span class="number">100</span></span><br><span class="line">    trainNum = <span class="built_in">int</span>(splitNum * totalNum)</span><br><span class="line">    valNum = totalNum - trainNum</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;训练集划分:&#x27;</span>+<span class="built_in">str</span>(trainNum), </span><br><span class="line">          <span class="string">&#x27;验证集划分:&#x27;</span>+<span class="built_in">str</span>(valNum), </span><br><span class="line">          <span class="string">&#x27;测试集划分:&#x27;</span>+<span class="built_in">str</span>(testNum))</span><br><span class="line">    <span class="comment"># print(txtPath)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 原始文件名字</span></span><br><span class="line">    randomList = []</span><br><span class="line">    <span class="keyword">for</span> jpgname <span class="keyword">in</span> imageList:</span><br><span class="line">        filename = jpgname.replace(<span class="string">&#x27;.jpg&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        randomList.append(filename)</span><br><span class="line"></span><br><span class="line">    np.random.shuffle(randomList)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建文件夹</span></span><br><span class="line">    localtime = time.asctime()</span><br><span class="line">    localtime = localtime.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;-&#x27;</span>).replace(<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="comment"># 一级目录</span></span><br><span class="line">    os.makedirs(<span class="string">&#x27;./dataSet-&#x27;</span>+localtime, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    <span class="comment"># 二级目录</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">&#x27;train&#x27;</span>, <span class="string">&#x27;val&#x27;</span>, <span class="string">&#x27;test&#x27;</span>]:</span><br><span class="line">        os.makedirs(<span class="string">&#x27;./dataSet-&#x27;</span>+localtime+<span class="string">&#x27;/&#x27;</span>+i, exist_ok=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># 三级目录</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> [<span class="string">&#x27;images&#x27;</span>, <span class="string">&#x27;labels&#x27;</span>]:</span><br><span class="line">            os.makedirs(<span class="string">&#x27;./dataSet-&#x27;</span>+localtime+<span class="string">&#x27;/&#x27;</span>+i+<span class="string">&#x27;/&#x27;</span>+j, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># shutil.copy(src_file, target_path)</span></span><br><span class="line">    <span class="comment"># 文件的复制操作</span></span><br><span class="line">    <span class="comment"># images复制</span></span><br><span class="line">    <span class="keyword">for</span> imagefileTrain <span class="keyword">in</span> randomList[<span class="number">0</span>:trainNum]:</span><br><span class="line">        shutil.copy(imagePath+imagefileTrain+<span class="string">&#x27;.jpg&#x27;</span>, <span class="string">&#x27;./dataSet-&#x27;</span>+localtime+<span class="string">&#x27;/train/images/&#x27;</span>+imagefileTrain+<span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">for</span> imagefileVal <span class="keyword">in</span> randomList[trainNum: trainNum+valNum]:</span><br><span class="line">        shutil.copy(imagePath+imagefileVal+<span class="string">&#x27;.jpg&#x27;</span>, <span class="string">&#x27;./dataSet-&#x27;</span>+localtime+<span class="string">&#x27;/val/images/&#x27;</span>+imagefileVal+<span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> imagefileTest <span class="keyword">in</span> randomList[trainNum+valNum:]:</span><br><span class="line">        shutil.copy(imagePath+imagefileTest+<span class="string">&#x27;.jpg&#x27;</span>, <span class="string">&#x27;./dataSet-&#x27;</span>+localtime+<span class="string">&#x27;/test/images/&#x27;</span>+imagefileTest+<span class="string">&#x27;.jpg&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># txt文件复制</span></span><br><span class="line">    <span class="keyword">for</span> txtfileTrain <span class="keyword">in</span> randomList[<span class="number">0</span>:trainNum]:</span><br><span class="line">        shutil.copy(txtPath+txtfileTrain+<span class="string">&#x27;.txt&#x27;</span>, <span class="string">&#x27;./dataSet-&#x27;</span>+localtime+<span class="string">&#x27;/train/labels/&#x27;</span>+txtfileTrain+<span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">for</span> txtfileVal <span class="keyword">in</span> randomList[trainNum: trainNum+valNum]:</span><br><span class="line">        shutil.copy(txtPath+txtfileVal+<span class="string">&#x27;.txt&#x27;</span>, <span class="string">&#x27;./dataSet-&#x27;</span>+localtime+<span class="string">&#x27;/val/labels/&#x27;</span>+txtfileVal+<span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> txtfileTest <span class="keyword">in</span> randomList[trainNum+valNum:]:</span><br><span class="line">        shutil.copy(txtPath+txtfileTest+<span class="string">&#x27;.txt&#x27;</span>, <span class="string">&#x27;./dataSet-&#x27;</span>+localtime+<span class="string">&#x27;/test/labels/&#x27;</span>+txtfileTest+<span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;运行完毕&#x27;</span>)</span><br></pre></td></tr></table></figure><p>运行后的脚本会产生一个文件夹，类似于：dataSet-Fri-Ju1-19-15-32-49-2024</p><p>其二级目录含有test，val、train文件夹</p><p>其三级目录含有images，labels文件夹</p><p>内部存有已经分配好的图片与标签。</p>]]></content>
      
      
      <categories>
          
          <category> 深度学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pytorch </tag>
            
            <tag> 深度学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>多浓度线虫高糖培养基配方记录</title>
      
      <link href="/posts/68b706de.html"/>
      <url>/posts/68b706de.html</url>
      
        <content type="html"><![CDATA[<p>记于2025-6-11</p><p>要求（<strong>100 mg&#x2F;mL</strong>母液浓度，配制400 mL培养基的目标浓度），使用稀释公式 <strong><strong><strong>C</strong></strong>₁V</strong><strong>₁ &#x3D; C<strong><strong>₂V</strong></strong>₂</strong> 计算各浓度所需母液体积（单位：μg&#x2F;mL与mL需统一）</p><p>具体计算如下：</p><h1 id="🔢-关键参数"><a href="#🔢-关键参数" class="headerlink" title="🔢 关键参数"></a><strong>🔢 关键参数</strong></h1><ul><li><strong><strong><strong>母液浓度 (C</strong></strong>₁)</strong>****：100 mg&#x2F;mL &#x3D; <strong><strong><strong>100,000 μg&#x2F;mL</strong></strong></strong>（1 mg &#x3D; 1000 μg）</li><li><strong><strong><strong>目标体积 (V</strong></strong>₂)</strong>****：400 mL</li><li><strong><strong><strong>目标浓度 (C</strong></strong>₂)</strong>****：25、50、100、200、500 μg&#x2F;mL</li><li><strong><strong><strong>需加母液体积 (V</strong></strong>₁)</strong><strong>**：按公式 <strong><strong><strong>V</strong></strong>₁ &#x3D; (C</strong>**₂ <strong><strong>× V</strong></strong>₂) &#x2F; C</strong><strong>₁</strong></li></ul><h1 id="📊-计算结果"><a href="#📊-计算结果" class="headerlink" title="📊 计算结果"></a><strong>📊 计算结果</strong></h1><table><thead><tr><th><strong>目标浓度(μg&#x2F;mL)</strong></th><th><strong>需加母液体积(μL)</strong></th><th><strong>计算公式与过程</strong></th></tr></thead><tbody><tr><td>25</td><td><strong><strong><strong>100 μL</strong></strong></strong></td><td>(25  × 400) ÷ 100,000 &#x3D; 0.1 mL &#x3D; 100 μL</td></tr><tr><td>50</td><td><strong><strong><strong>200 μL</strong></strong></strong></td><td>(50  × 400) ÷ 100,000 &#x3D; 0.2 mL &#x3D; 200 μL</td></tr><tr><td>100</td><td><strong><strong><strong>400 μL</strong></strong></strong></td><td>(100  × 400) ÷ 100,000 &#x3D; 0.4 mL &#x3D; 400 μL</td></tr><tr><td>200</td><td><strong><strong><strong>800 μL</strong></strong></strong></td><td>(200  × 400) ÷ 100,000 &#x3D; 0.8 mL &#x3D; 800 μL</td></tr><tr><td>500</td><td><strong><strong><strong>2000 μL</strong></strong></strong></td><td>(500  × 400) ÷ 100,000 &#x3D; 2 mL &#x3D; 2000 μL</td></tr></tbody></table><h1 id="⚠️-操作注意事项"><a href="#⚠️-操作注意事项" class="headerlink" title="⚠️ 操作注意事项"></a><strong>⚠️ 操作注意事项</strong></h1><ol><li><strong><strong><strong>单位转换</strong></strong></strong>：所有浓度单位需统一为μg&#x2F;mL（母液100 mg&#x2F;mL &#x3D; 100,000 μg&#x2F;mL）</li><li><strong><strong><strong>体积控制</strong></strong></strong>：<ul><li>需将母液加入400 mL培养基中，<strong><strong><strong>最终总体积需严格为400 mL</strong></strong></strong>（若培养基初始体积不足400 mL，需先补足溶剂再添加母液）</li><li>例如：配制500 μg&#x2F;mL时，需取<strong><strong><strong>2000 μL母液</strong></strong></strong>加入<strong><strong><strong>398 mL培养基</strong></strong></strong>（400 mL - 2 mL &#x3D; 398 mL）。</li></ul></li><li><strong><strong><strong>混合均匀</strong></strong></strong>：加入母液后需充分搅拌或震荡培养基，确保浓度均一</li></ol><h1 id="💎-总结步骤"><a href="#💎-总结步骤" class="headerlink" title="💎 总结步骤"></a><strong>💎 总结步骤</strong></h1><ol><li>取400 mL培养基（若为固体需预先溶解）；</li><li>按上表体积加入母液；</li><li>混合均匀后即可使用。</li></ol>]]></content>
      
      
      <categories>
          
          <category> 湿实验相关 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 秀丽隐杆线虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>余甘子/野菊花水提冻干粉制备方法记录</title>
      
      <link href="/posts/e7b3ef8a.html"/>
      <url>/posts/e7b3ef8a.html</url>
      
        <content type="html"><![CDATA[<p>记于2025-5-31</p><p>制备余甘子、野菊花、余甘子&#x2F;野菊花 ： 1：1 冻干粉</p><h1 id="余甘子水提物的制备："><a href="#余甘子水提物的制备：" class="headerlink" title="余甘子水提物的制备："></a>余甘子水提物的制备：</h1><p>称取 50 g 余甘子粉末放入烧杯，料 液比质量比为 1：20，在 80°C水浴下连续搅拌 40 min，得到的滤液在 8000 r·min-1 离心 10 min，收集上清液，重复该步骤 2次，将2次上清液合并抽滤。使用旋蒸仪设置温度70°C 进行浓缩至100ml，将浓缩后的溶液进行冷冻干燥，并保存于干燥器中备用</p><h1 id="野菊花水提物的制备："><a href="#野菊花水提物的制备：" class="headerlink" title="野菊花水提物的制备："></a>野菊花水提物的制备：</h1><p>称取 50 g 野菊花粉末放入烧杯，料 液比质量比为 1：20，在 80°C水浴下连续搅拌 40 min，得到的滤液在 8000 r·min-1 离心 10 min，收集上清液，重复该步骤 2次，将2次上清液合并抽滤。使用旋蒸仪设置温度70°C 进行浓缩至100ml，将浓缩后的溶液进行冷冻干燥，并保存于干燥器中备用</p><h1 id="1比1余甘子-野菊花水提物的制备："><a href="#1比1余甘子-野菊花水提物的制备：" class="headerlink" title="1比1余甘子&#x2F;野菊花水提物的制备："></a>1比1余甘子&#x2F;野菊花水提物的制备：</h1><p>称取 25g 余甘子粉末和25g野菊花1:1混合放入烧杯，料液比质量比为 1：20，在 80°C水浴下连续搅拌 40 min，得到的滤液在 8000 r·min-1 离心 10 min，收集上清液，重复该步骤 2次，将2次上清液合并抽滤。使用旋蒸仪设置温度70°C 进行浓缩至100ml，将浓缩后的溶液进行冷冻干燥，并保存于干燥器中备用</p><h1 id="UPLC-MS分析前期准备"><a href="#UPLC-MS分析前期准备" class="headerlink" title="UPLC-MS分析前期准备"></a>UPLC-MS分析前期准备</h1><p>取适量的水提物冻干粉末，使用甲醇配制溶液用于LC-MS分析，浓度0.25 g&#x2F;mL，检测前经0.22 μm滤膜过滤</p><h1 id="UPLC-Q-Exactive-MS分析"><a href="#UPLC-Q-Exactive-MS分析" class="headerlink" title="UPLC-Q-Exactive&#x2F;MS分析"></a>UPLC-Q-Exactive&#x2F;MS分析</h1><p>分析在Thermo Scientific Q Exactive高分辨质谱仪（美国Thermo Fisher公司）上完成。</p><p>样品分离采用ACQUITY® UPLC BEH C18色谱柱（2.1毫米×100毫米，1.7微米，Waters公司），柱温30℃，流速0.2毫升&#x2F;分钟，进样量5微升。流动相A为0.1%甲酸水溶液，流动相B为乙腈。</p><p>冻干粉末样品的梯度洗脱程序如下：初始-2.0分钟，95%-90%A；2.0-4.0分钟，90%-88%A；4.0-13分钟，88%-77%A；13-22分钟，77%A；22-27分钟，77%-72%A；27-37分钟，72%-38%A；37-42分钟，38%-5%A。</p>]]></content>
      
      
      <categories>
          
          <category> 湿实验相关 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      
        <title>基于gromacs模拟蛋白-配体复合物过程记录</title>
      
      <link href="/posts/16e6f526.html"/>
      <url>/posts/16e6f526.html</url>
      
        <content type="html"><![CDATA[<h1 id="生成蛋白拓扑文件"><a href="#生成蛋白拓扑文件" class="headerlink" title="生成蛋白拓扑文件"></a>生成蛋白拓扑文件</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gmx pdb2gmx -f protein.pdb -o protein.gro -p topol.top -ignh</span><br><span class="line">6</span><br><span class="line">1</span><br></pre></td></tr></table></figure><p>将配体gro加入到蛋白gro并合并，加上原子数目<br>用vmd检查</p><h1 id="生成小分子限制势文件"><a href="#生成小分子限制势文件" class="headerlink" title="生成小分子限制势文件"></a>生成小分子限制势文件</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gmx genrestr –f GPH_1npc.gro -o posre_1npc.itp</span><br><span class="line">System</span><br></pre></td></tr></table></figure><p>Topol.top修改（引入配体位置限制性文件）：<br>原来：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">; ; Include forcefield parameters</span><br><span class="line">#include &quot;amber99sb-ildn.ff/forcefield.itp&quot;[ moleculetype ]</span><br><span class="line">; Name            nrexcl</span><br><span class="line">Protein_chain_A     3</span><br></pre></td></tr></table></figure><p>修改成：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">; Include forcefield parameters</span><br><span class="line">#include &quot;amber99sb-ildn.ff/forcefield.itp&quot;; include chain topologies</span><br><span class="line">#include &quot;GPH_1npc.itp&quot;[ moleculetype ]</span><br><span class="line">; Name            nrexcl</span><br><span class="line">Protein_chain_A     3</span><br></pre></td></tr></table></figure><p>末尾部分：<br>原来：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ molecules ]</span><br><span class="line">; Compound        #mols</span><br><span class="line">Protein_chain_A     1</span><br></pre></td></tr></table></figure><p>修改成：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ molecules ]</span><br><span class="line">; Compound        #mols</span><br><span class="line">Protein_chain_A     1</span><br><span class="line">GPH_1npc          1</span><br></pre></td></tr></table></figure><p>GPH_1npc.itp文件修改：<br>在末尾处加入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#ifdef POSERES</span><br><span class="line">#include &quot;posre_1npc.itp&quot;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><h1 id="设立盒子"><a href="#设立盒子" class="headerlink" title="设立盒子:"></a>设立盒子:</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx editconf -f complex.gro -o complex_box.gro -d 0.8 -bt cubic</span><br></pre></td></tr></table></figure><h1 id="加水："><a href="#加水：" class="headerlink" title="加水："></a>加水：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx solvate -cp complex_box.gro -o complex_SOL.gro -p topol.top</span><br></pre></td></tr></table></figure><p>em.mdp  pr.mdp  md.mdp放入当前目录。<br>生成可执行文件: (改拓扑)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx grompp -f em.mdp -c complex_SOL.gro -p topol.top -o em.tpr -maxwarn 1</span><br></pre></td></tr></table></figure><h1 id="加离子："><a href="#加离子：" class="headerlink" title="加离子："></a>加离子：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx genion -s em.tpr -p topol.top -o system.gro -neutral   (选SOL)</span><br></pre></td></tr></table></figure><h1 id="能量最小化："><a href="#能量最小化：" class="headerlink" title="能量最小化："></a>能量最小化：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gmx grompp -f em.mdp -c system.gro -p topol.top -o em.tpr</span><br><span class="line">gmx mdrun -v -deffnm em</span><br></pre></td></tr></table></figure><h1 id="限制性动力学模拟100ps"><a href="#限制性动力学模拟100ps" class="headerlink" title="限制性动力学模拟100ps"></a>限制性动力学模拟100ps</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gmx grompp -f pr.mdp -c em.gro -p topol.top -r em.gro -o pr.tpr</span><br><span class="line">gmx mdrun -v -deffnm pr</span><br></pre></td></tr></table></figure><h1 id="常规的动力学模拟："><a href="#常规的动力学模拟：" class="headerlink" title="常规的动力学模拟："></a>常规的动力学模拟：</h1><p>产生索引文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx make_ndx -f pr.gro</span><br></pre></td></tr></table></figure><p>输入：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 | 13    (定义蛋白-配体组，新组号为22)</span><br><span class="line">!22   (把其他部分定义为一个组，新组号为23)</span><br><span class="line">name 22 protein_lig (改名)</span><br><span class="line">name 23 envir   （环境）</span><br><span class="line">q</span><br></pre></td></tr></table></figure><p>跑常规动力学模拟</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gmx grompp -f md.mdp -c pr.gro -p topol.top -o md.tpr -n index.ndx -maxwarn 10</span><br><span class="line">gmx mdrun -v -deffnm md</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 生物信息 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分子动力学模拟 </tag>
            
            <tag> gromacs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>分子动力学结果简易分析教程</title>
      
      <link href="/posts/91ce7da7.html"/>
      <url>/posts/91ce7da7.html</url>
      
        <content type="html"><![CDATA[<h1 id="分析蛋白质和配体的骨架："><a href="#分析蛋白质和配体的骨架：" class="headerlink" title="分析蛋白质和配体的骨架："></a>分析蛋白质和配体的骨架：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx rms -f md.xtc -s md.tpr -o rmsd_protein.xvg -tu ns</span><br></pre></td></tr></table></figure><p>两次选择backbone</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qtgrace rmsd_protein.xvg</span><br></pre></td></tr></table></figure><h1 id="接下来检查配体分子的骨架："><a href="#接下来检查配体分子的骨架：" class="headerlink" title="接下来检查配体分子的骨架："></a>接下来检查配体分子的骨架：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx rms -f md.xtc -s md.tpr -o rmsd_lig.xvg -tu ns</span><br></pre></td></tr></table></figure><p>第一次选bcakbone，第二次选MOL，代表结构对蛋白骨架做叠合，只计算MOL的RMSD，考查配体分子的RMSD。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qtgrace rmsd_lig.xvg</span><br></pre></td></tr></table></figure><h1 id="考查氢键"><a href="#考查氢键" class="headerlink" title="考查氢键"></a>考查氢键</h1><p>创建并进入hbond目录，在cmd下运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx hbond -f ../md.xtc -s ../md.tpr -hbn -hbm -nomerge -tu ns</span><br></pre></td></tr></table></figure><p>选择protein和MOL组</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">13</span><br><span class="line">qtgrace hbnum.xvg</span><br></pre></td></tr></table></figure><h1 id="考察rmsf"><a href="#考察rmsf" class="headerlink" title="考察rmsf"></a>考察rmsf</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx rmsf -s md.tpr -f md.xtc -o rmsf.xvg -res</span><br></pre></td></tr></table></figure><p>选择protein组</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">qtgrace rmsf.xvg</span><br></pre></td></tr></table></figure><h1 id="考察sasa"><a href="#考察sasa" class="headerlink" title="考察sasa"></a>考察sasa</h1><p>在git bash上运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gmx sasa -f md.xtc -s md.tpr -surface &#x27;group protein&#x27; -output &#x27;&quot;Hydrophobic&quot; group protein and charge &#123;-0.2 to 0.2&#125;; &quot;Hydrophilic&quot; group protein and not charge &#123;-0.2 to 0.2&#125;&#x27;</span><br><span class="line"></span><br><span class="line">qtgrace -nxy area.xvg</span><br></pre></td></tr></table></figure><h1 id="考察Rg"><a href="#考察Rg" class="headerlink" title="考察Rg"></a>考察Rg</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gmx gyrate -s md.tpr -f md.xtc -o gyrate.xvg</span><br><span class="line"></span><br><span class="line">qtgrace gyrate.xvg</span><br></pre></td></tr></table></figure><h1 id="mmpbsa分析"><a href="#mmpbsa分析" class="headerlink" title="mmpbsa分析"></a>mmpbsa分析</h1><p>轨迹矫正（选择系统）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx trjconv -s md.tpr -f md.xtc -o md_noPBC.xtc -center -pbc mol -ur compact</span><br></pre></td></tr></table></figure><p>采样90-100ns轨迹，一般认为更加稳定</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx trjconv -f md_noPBC.xtc -o trj_90-100ns.xtc -b 90000 -e 100000</span><br></pre></td></tr></table></figure><p>轨迹检查</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx check -f trj_90-100ns.xtc</span><br></pre></td></tr></table></figure><p>mmpbsa分析，基于李继存老师的分析脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmx_mmpbsa.bsh -f trj_90-100ns.xtc -s md.tpr -n index.ndx -pro Protein -lig MOL</span><br></pre></td></tr></table></figure><h1 id="VMD分析"><a href="#VMD分析" class="headerlink" title="VMD分析"></a>VMD分析</h1><p>在VMD主界面下点击Graphics ——&gt; Representations ——&gt; selected Atoms下输入：</p><p>显示蛋白<br>protein</p><p>显示配体<br>resname MOL</p><p>显示氧原子&#x2F;氮原子氢键周围3埃内原子<br>not water and same resid as within 3.0 of index xx xx xx</p>]]></content>
      
      
      <categories>
          
          <category> 生物信息 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 分子动力学模拟 </tag>
            
            <tag> gromacs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      
        <title>Hello World</title>
      
      <link href="/posts/4a17b156.html"/>
      <url>/posts/4a17b156.html</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
